<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title></title>
</head>

<nav class="navbar navbar-dark top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">Profile</a>
    <input id="search" name="search" class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
    {{/*    <input id="search" onkeyup="mySearch()" class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">*/}}
    <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap">
            <a class="nav-link" href="/login" >Sign out</a>
        </li>
    </ul>
</nav>

<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="sidebar-sticky">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="/api">
                            <i class="fa fa-home"></i>
                            Dashboard <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fa fa-file"></i>
                            Description
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Dashboard</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <div class="btn-group mr-2">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                        <span data-feather="calendar"></span>
                        This week
                    </button>
                </div>
            </div>
            <div class="table-responsive">
{{/*                <table class="table table-striped table-sm" id="mytable">*/}}
                <table class="table table-striped table-bordered table-sm" id="mytable">
                    <thead>
                    <tr>
                        <th colspan="8" style="text-align:center">Invoices</th>
                    </tr>
                    <tr>
                        <th style="text-align:center" >Document</th>
                        <th style="text-align:center">Amount</th>
                        <th style="text-align:center">ReferenceMonth</th>
                        <th style="text-align:center">ReferenceYear</th>
                        <th style="text-align:center">IsActive</th>
                        <th style="text-align:center">CreatedAt</th>
                        <th style="text-align:center">DeactivatedAt</th>
                    </tr>
                    </thead>
                    <tbody id="invoicesTable">
                    {{range $y, $x := . }}
                        <tr>
                            <td style="text-align:center">{{$x.Document}}</td>
                            <td style="text-align:center">{{ $x.Amount }}</td>
                            <td style="text-align:center">{{ $x.ReferenceMonth }}</td>
                            <td style="text-align:center">{{ $x.ReferenceYear }}</td>
                            <td style="text-align:center">{{ $x.IsActive }}</td>
                            <td style="text-align:center">{{ $x.CreatedAt }}</td>
                            <td style="text-align:center">{{ $x.DeactivatedAt }}</td>
                        </tr>
                    {{end}}
                    </tbody>
                </table>
            </div>
        </main>
    </div>
</div>

<div>
    <div class="btn-group mr-2" style="position:fixed;">
    <span style="position:absolute; left:350px;">
        <form>
            <div class="btn-group">
            <button type="submit" class="btn btn-dark btn-outline-primary" formaction="/api/addPage">Add invoice</button>
            <button type="submit" class="btn btn-dark btn-outline-primary" formaction="/api">Refresh Table</button>
            </div>
        </form>
    </span>
    </div>
</div>

{{/*dynamic search table*/}}
<script>
    $(document).ready(function () {
        $('#search').keyup(function () {
            search_table($(this).val());
        });
        function search_table(value) {
            $('#invoicesTable tr').each(function () {
                var found = 'false';
                $(this).each(function () {
                    if($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0)
                    {
                        found = 'true';
                    }
                });
                if (found === 'true')
                {
                    $(this).show();
                }
                else {
                    $(this).hide();
                }
            });
        }
    });
</script>

{{/*sort table by column values*/}}
<script>
    $('th').click(function(){
        var table = $(this).parents('#mytable').eq(0)
        var rows = table.find('tr:gt(1)').toArray().sort(comparer($(this).index()))
        this.asc = !this.asc
        if (!this.asc){rows = rows.reverse()}
        for (var i = 0; i < rows.length +1; i++){table.append(rows[i])}
    })
    function comparer(index) {
        return function(a, b) {
            var valA = getCellValue(a, index), valB = getCellValue(b, index)
            return $.isNumeric(valA) && $.isNumeric(valB) ? valA - valB : valA.toString().localeCompare(valB)
        }
    }
    function getCellValue(row, index){ return $(row).children('td').eq(index).text()}
</script>